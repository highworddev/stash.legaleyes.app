<!DOCTYPE html>
<html lang="en" dir="ltr">

<head>
  <meta charset="utf-8">
  <title>LegalEyes Stash | Cannabis Calculator</title>
  <meta name="title" content="LegalEyes Stash | Cannabis Calculator" />
  <meta name="application-name" content="LegalEyes Stash | Cannabis Calculator">
  <meta name="author" content="High World Design Inc." />
  <meta name=description content="Quickly calculate your legal Cannabis stash. Works offline!">
  <meta name="rating" content="Restricted" />
  <meta name="full-screen" content="yes" />
  <meta name=viewport content="width=device-width, maximum-scale=2">
  <meta name="mobile-web-app-capable" content="yes">
  <meta name="theme-color" content="#2C7A2E">
  <meta name="msapplication-TileColor" content="#2C7A2E">
  <meta name="msapplication-TileImage" content="./images/icons/mstile-150x150.png">
  <meta name="msapplication-tooltip" content="Quickly calculate your legal Cannabis stash. Works offline!" />
  <meta name="msapplication-starturl" content="/" />
  <meta name="msapplication-TileColor" content="#fff" />
  <meta name="apple-mobile-web-app-capable" content="yes">
  <meta name="apple-mobile-web-app-status-bar-style" content="black-translucent">
  <meta name="apple-mobile-web-app-title" content="LegalEyes Stash">
  <meta name="robots" content="all" />
  <meta name="generator" content="LegalEyes Stash" />
  <meta name="renderer" content="webkit|ie-comp|ie-stand" />
  <meta http-equiv=X-UA-Compatible content="IE=edge">
  <!-- Social -->
  <meta name="twitter:title" content="LegalEyes Stash | Cannabis Calculator" />
  <meta property="og:title" content="LegalEyes Stash | Cannabis Calculator" />
  <meta name="description" content="Quickly calculate your legal Cannabis stash. Works offline!" />
  <meta name="twitter:description" content="Quickly calculate your legal Cannabis stash. Works offline!" />
  <meta property="og:description" content="Quickly calculate your legal Cannabis stash. Works offline!" />
  <meta property="og:site_name" content="LegalEyes Stash | Cannabis Calculator" />
  <meta name="twitter:card" content="summary" />
  <meta property="og:type" content="article" />
  <meta property="og:url" content="https://stash.legaleyes.app" />
  <link rel="manifest" href="./manifest.json">
  <link rel="stylesheet" href="./css/styles.css">
  <link rel="apple-touch-icon" href="./images/icons/apple-touch-icon.png">
  <link rel="icon" type="image/png" href="./images/icons/favicon-32x32.png" sizes="32x32">
  <link rel="icon" type="image/png" href="./images/icons/favicon-16x16.png" sizes="16x16">
  <!-- Schema -->
  <script type='application/ld+json'>
    {
      "@context": "http://schema.org/",
      "@type": "SoftwareApplication",
      "applicationCategory": "law, tools, cannabis, free, open source",
      "availableOnDevice": [
        "android",
        "ios",
        "microsoft",
        "browser"
      ],
      "downloadUrl": "https://stash.legaleyes.app",
      "installUrl": "https://stash.legaleyes.app",
      "operatingSystem": "native",
      "softwareVersion": "0.420"
    }
  </script>
</head>

<body>
  <style>

  </style>
  <tr class="app app__layout">
    <!-- Top Bar -->
    <header>
      <span class="header__icon">
        <svg class="menu__icon no--select" width="24px" height="24px" viewBox="0 0 48 48" fill="#fff">
          <path d="M6 36h36v-4H6v4zm0-10h36v-4H6v4zm0-14v4h36v-4H6z"></path>
        </svg>
      </span>
      <span class="header__title no--select">LegalEyes <strong>Stash</strong></span>
    </header>
    <!-- Menu -->
    <div class="menu">
      <div class="menu__header"></div>
      <ul class="menu__list">
        <li>
          <a id="homeLink" target="_self" rel="noopener" href="https://legaleyes.app">Base Site > legaleyes.app</a>
        </li>
        <li>
          <a href="http://www.facebook.com/legaleyesapp/" target="_blank" rel="noopener">facebook</a>
        </li>
        <li>
          <a href="http://www.duby.co/" target="_blank" rel="noopener">duby</a>
        </li>
        <li>
          <a href="http://www.instagram.com/legaleyesapp/" target="_blank" rel="noopener">instagram</a>
        </li>
        <li>
          <a href="http://www.linkedin.com/company/legaleyesapp/" target="_blank" rel="noopener">linkedin</a>
        </li>
        <li>
          <a href="http://app.massroots.com/user/legaleyesapp" target="_blank" rel="noopener">massroots</a>
        </li>
        <li>
          <a href="http://medium.com/@LegalEyesApp" target="_blank" rel="noopener">medium</a>
        </li>
        <li>
          <a href="http://www.pinterest.com/legaleyesapp" target="_blank" rel="noopener">pinterest</a>
        </li>
        <li>
          <a href="http://www.reddit.com/user/legaleyesapp/" target="_blank" rel="noopener">reddit</a>
        </li>
        <li>
          <a href="http://www.twitter.com/legaleyesapp/" target="_blank" rel="noopener">twitter</a>
        </li>
        <li>
          <a href="http://www.snapchat.com" target="_blank" rel="noopener">snapchat</a>
        </li>
        <li>
          <a href="http://www.quora.com/profile/LegalEyesApp" target="_blank" rel="noopener">quora</a>
        </li>
        <li>
          <a href="http://www.weedlife.com/legaleyesapp" target="_blank" rel="noopener">weedlife</a>
        </li>
        <li>
          <a href="http://www.youtube.com/channel/UCeUhxD01SqQs5sPaWAXLL5w" target="_blank" rel="noopener">youtube</a>
        </li>

      </ul>
    </div>
    <div class="menu__overlay"></div>
    <!-- Content -->

    <div class="app__content">
      <table>
        <caption>
          <h1>Cannabis Equivalent Amounts Calculator</h1>
        </caption>
        <tr class='stashItem'>
          <td><input type='number' id='holdingLimit' value='30' onclick='holding("holding",0)' /></td>
          <th><label for='holding'>Holding</label></th>
          <td><input type='number' id='holdingEquiv' value='0' disabled /></td>
          <td><input type='number' min='0' max='30' id='holding' data-ratio='1' value='0' disabled /></td>
        </tr>
        <tr>
          <th>Cannabis Form</th>
          <th>Holding</th>
          <th>Equivalent</th>
          <th>Remaining</th>
        </tr>
        <tr class='stashItem'>
          <th><label for='dried'>Dried</label></th>
          <td><input type='number' min='0' max='30' step='0.1' id='dried' data-ratio='1' value='0' onclick='cal("dried",1)' /></td>
          <td><input type='number' id='driedEquiv' value='0' disabled /></td>
          <td><input type='number' id='driedRemaining' value='30' disabled /></td>
        </tr>
        <tr class='stashItem'>
          <th><label for='fresh'>Fresh</label></th>
          <td><input type='number' min='0' max='150' step='5' id='fresh' data-ratio='5' value='0' onclick='cal("fresh",1)' /></td>
          <td><input type='number' id='freshEquiv' value='0' disabled /></td>
          <td><input type='number' id='freshRemaining' value='150' disabled /></td>
        </tr>
        <tr class='stashItem'>
          <th><label for='eatable'>Eatable</label></th>
          <td><input type='number' min='0' max='450' steps='0.1' id='eatable' data-ratio='15' value='0' onclick='cal("eatable",1)' /></td>
          <td><input type='number' id='eatableEquiv' value='0' disabled /></td>
          <td><input type='number' id='eatableRemaining' value='450' disabled /></td>
        </tr>
        <tr class='stashItem'>
          <th><label for='liquid'>Liquid</label></th>
          <td><input type='number' min='0' max='2100' step='10' id='liquid' data-ratio='70' value='0' onclick='cal("liquid",1)' /></td>
          <td><input type='number' id='liquidEquiv' value='0' disabled /></td>
          <td><input type='number' id='liquidRemaining' value='2100' disabled /></td>
        </tr>
        <tr class='stashItem'>
          <th><label for='concentrates'>Concentrates</label></th>
          <td><input type='number' min='0' max='7.5' step='0.1' id='concentrates' data-ratio='0.25' value='0' onclick='cal("concentrates",2)' /></td>
          <td><input type='number' id='concentratesEquiv' value='0' disabled /></td>
          <td><input type='number' id='concentratesRemaining' value='7.5' disabled /></td>
        </tr>
        <tr class='stashItem'>
          <th><label for='seed'>Seed</label></th>
          <td><input type='number' min='0' max='4' id='seed' data-ratio='7.5' value='0' onclick='cal("seed",0)' /></td>
          <td><input type='number' id='seedEquiv' value='0' disabled /></td>
          <td><input type='number' id='seedRemaining' value='4' disabled /></td>
        </tr>
      </table>
      <!-- Toast msg -->
      <div class="toast__msg"></div>
    </div>
    </div>

    <!-- JS  -->
    <script>
      let holdingTotal = document.getElementById('holding');

      function cal(id, round) {
        let type = document.getElementById(id);
        let equiv = document.getElementById(id + 'Equiv');
        let remain = document.getElementById(id + 'Remaining');
        let numb = type.value / type.dataset.ratio;
        remain.value = remain.value - type.values
        numb = numb.toFixed(round);
        equiv.value = numb;
        remain.value =  holdingTotal.value * type.dataset.ratio - equiv.value;
        holdingTotal.value = holdingTotal.value  + numb;
      }

      function holding(id, round) {
        document.getElementById(id + 'Remaining').value = type.value / type.dataset.ratio + "g";
      }

      //If serviceWorker supports, then register it.
      if ("serviceWorker" in navigator) {
        navigator.serviceWorker.register('./serviceWorker.js', {
            scope: "./"
          }) //setting scope of sw
          .then(function (registration) {
            console.info('Service worker is registered!');
            checkForPageUpdate(registration); // To check if new content is updated or not
          })
          .catch(function (error) {
            console.error('Service worker failed ', error);
          });
      }

      // To content update on service worker state change
      function checkForPageUpdate(registration) {
        // onupdatefound will fire on first time install and when serviceWorker.js file changes      
        registration.addEventListener("updatefound", function () {
          // To check if service worker is already installed and controlling the page or not
          if (navigator.serviceWorker.controller) {
            var installingSW = registration.installing;
            installingSW.onstatechange = function () {
              console.info("Service Worker State :", installingSW.state);
              switch (installingSW.state) {
                case 'installed':
                  // Now new contents will be added to cache and old contents will be remove so
                  // this is perfect time to show user that page content is updated.
                  toast('The Stash app has an updated. Refresh the page for update.', 5000);
                  break;
                case 'redundant':
                  throw new Error('The installing service worker became redundant.');
              }
            }
          }
        });
      }

      var bgSyncTextElement = document.querySelector('.bg-sync__text');
      var bgSyncElement = document.querySelector('.custom__button-bg');


      //Listen postMessage when `background sync` is triggered
      navigator.serviceWorker.addEventListener('message', function (event) {
        console.info('From background sync: ', event.data);
        fetchGitUserInfo(localStorage.getItem('request'), true);
        bgSyncElement.classList.remove('hide'); //Once sync event fires, show register toggle button
        bgSyncTextElement.setAttribute('hidden', true); //Once sync event fires, remove registered label
      });

      var headerElement = document.querySelector('header');
      var metaTagTheme = document.querySelector('meta[name=theme-color]');

      //After DOM Loaded
      document.addEventListener('DOMContentLoaded', function (event) {
        //On initial load to check connectivity
        if (!navigator.onLine) {
          updateNetworkStatus();
        }

        window.addEventListener('online', updateNetworkStatus, false);
        window.addEventListener('offline', updateNetworkStatus, false);
      });

      //To update network status
      function updateNetworkStatus() {
        if (navigator.onLine) {
          metaTagTheme.setAttribute('content', '#0288d1');
          headerElement.classList.remove('app__offline');
        } else {
          toast('App is offline');
          metaTagTheme.setAttribute('content', '#6b6b6b');
          headerElement.classList.add('app__offline');
        }
      }

      var menuIconElement = document.querySelector('.header__icon');
      var menuElement = document.querySelector('.menu');
      var menuOverlayElement = document.querySelector('.menu__overlay');

      // ** Menu **
      //Menu click event
      menuIconElement.addEventListener('click', showMenu, false);
      menuOverlayElement.addEventListener('click', hideMenu, false);
      menuElement.addEventListener('transitionend', onTransitionEnd, false);

      //To show menu
      function showMenu() {
        menuElement.style.transform = "translateX(0)";
        menuElement.classList.add('menu--show');
        menuOverlayElement.classList.add('menu__overlay--show');
      }

      //To hide menu
      function hideMenu() {
        menuElement.style.transform = "translateX(-110%)";
        menuElement.classList.remove('menu--show');
        menuOverlayElement.classList.remove('menu__overlay--show');
        menuElement.addEventListener('transitionend', onTransitionEnd, false);
      }

      var touchStartPoint, touchMovePoint;

      /*Swipe from edge to open menu*/

      //`TouchStart` event to find where user start the touch
      document.body.addEventListener('touchstart', function (event) {
        touchStartPoint = event.changedTouches[0].pageX;
        touchMovePoint = touchStartPoint;
      }, false);

      //`TouchMove` event to determine user touch movement
      document.body.addEventListener('touchmove', function (event) {
        touchMovePoint = event.touches[0].pageX;
        if (touchStartPoint < 10 && touchMovePoint > 30) {
          menuElement.style.transform = "translateX(0)";
        }
      }, false);

      function onTransitionEnd() {
        if (touchStartPoint < 10) {
          menuElement.style.transform = "translateX(0)";
          menuOverlayElement.classList.add('menu__overlay--show');
          menuElement.removeEventListener('transitionend', onTransitionEnd, false);
        }
      }
    </script>
    <script src="./js/toast.js"></script>
    <!-- Google -->
    <script async src="https://www.googletagmanager.com/gtag/js?id=UA-127158649-1"></script>
    <script>
      window.dataLayer = window.dataLayer || [];

      function gtag() {
        dataLayer.push(arguments);
      }
      gtag('js', new Date());
      gtag('config', 'UA-127158649-1');
    </script>
</body>

</html>